{{ $sass := resources.Get "sass/contributors-map.sass" }}
{{ $style := $sass | css.Sass }}
<link rel="stylesheet" href="{{ $style.RelPermalink }}">

<!-- Load Font Awesome -->
{{ $fontawesome := resources.Get "css/fontawesome.css" }}
<link rel="stylesheet" href="{{ $fontawesome.RelPermalink }}">

<!-- Load MapLibre GL -->
{{ $maplibreCSS := resources.Get "libs/maplibre/maplibre-gl.css" }}
<link rel="stylesheet" href="{{ $maplibreCSS.RelPermalink }}">

<!-- Load OpenLayers -->
{{ $olCSS := resources.Get "libs/openlayers/ol.css" }}
<link rel="stylesheet" href="{{ $olCSS.RelPermalink }}">

<div class="contributors-map-container">
  <div class="loading-spinner">
    Loading contributors map...
  </div>
  
  <!-- Map Controls -->
  <div class="map-controls">
    <button id="globe-view-btn" class="map-view-toggle active" title="Globe View">
      <i class="fas fa-globe"></i>
    </button>
    <button id="flat-view-btn" class="map-view-toggle" title="Flat Map">
      <i class="fas fa-map"></i>
    </button>
  </div>
  
  <!-- Globe View -->
  <div id="globe-view"></div>
  
  <!-- Flat Map View -->
  <div id="flat-map-view"></div>
</div>

<!-- Legend (outside map container) -->
<div class="map-legend">
  <h4>Contribution Levels</h4>
  <div class="legend-items-grid">
    <div class="legend-item">
      <div class="legend-circle" style="width: 84px; height: 84px;"></div>
      <span>10,000+ commits</span>
    </div>
    <div class="legend-item">
      <div class="legend-circle" style="width: 66px; height: 66px;"></div>
      <span>5,000+ commits</span>
    </div>
    <div class="legend-item">
      <div class="legend-circle" style="width: 54px; height: 54px;"></div>
      <span>1,000+ commits</span>
    </div>
    <div class="legend-item">
      <div class="legend-circle" style="width: 42px; height: 42px;"></div>
      <span>500+ commits</span>
    </div>
    <div class="legend-item">
      <div class="legend-circle" style="width: 36px; height: 36px;"></div>
      <span>&lt; 500 commits</span>
    </div>
  </div>
</div>

<!-- Contributor Popup -->
<div id="popup-overlay" class="popup-overlay"></div>
<div id="contributor-popup" class="contributor-tooltip">
  <button id="popup-close" class="tooltip-close">Ã—</button>
  <div class="card contributor-card" id="popup-card">
    <div class="card-content has-text-centered">
      <div class="avatar-container">
        <img id="popup-avatar" src="" alt="Avatar" class="avatar">
      </div>
      <h3 class="title is-4">
        <a id="popup-username-link" href="" target="_blank" rel="noopener" class="external-link"></a>
      </h3>
      <div class="total-contributions mb-4 is-flex is-justify-content-center is-align-items-center">
        <span class="tag is-light is-medium has-text-weight-semibold mr-1 is-rounded">
          <i class="fab fa-git-alt mr-1 has-text-info"></i>
          <span id="popup-total-contributions"></span>
        </span>
        <span class="has-text-grey">commits</span>
      </div>
      <div class="contribution-badges" id="popup-thematics-list"></div>
    </div>
  </div>
</div>

<!-- Load MapLibre GL JS -->
{{ $maplibreJS := resources.Get "libs/maplibre/maplibre-gl.js" }}
<script src="{{ $maplibreJS.RelPermalink }}"></script>

<!-- Load OpenLayers JS -->
{{ $olJS := resources.Get "libs/openlayers/ol.js" }}
<script src="{{ $olJS.RelPermalink }}"></script>

<!-- Load map functionality -->
{{ $js := resources.Get "js/contributors-map.js" }}
<script src="{{ $js.RelPermalink }}"></script>
